#labels InnoDB,SSD,Flash,Cache
= Introduction =

Enable using flash memory or solid state drive(SSD) as innodb's secondary buffer pool.<br>
This feature is much like flash cache in Oracle's Exadata

After enable this feature, when the page was removed from the innodb buffer pool, InnoDB will move it to the flash memory or ssd storage. When InnoDB read a new page which is not in the buffer pool, it will read the secondary buffer pool first. If the page is cached in secondary buffer pool, it will not read the disk. Because the high random read performance of flash memory or ssd, this will boost the database performance.

For using innodb secondary buffer pool, it is highly recommand you using 64 bit os system.

Currently, flash cache do not cache the data in share tablespace (ibdata1). Hence, you must use --innodb_file_per_table parameter to enable flash cache.

= TPC-C benchmark =

Server: Intel(R) Xeon Quad-Core E5405 2.00GHz X 2<br>

Database: 1G ( created by tpcc_load, 10 warehouse )<br>

flash storage: 1G normal flash memory (995M after format)<br>

test: tpcc_start 127.0.0.1 tpcc root '123456' 10 16 600 1200<br>

|| *innodb_buffer_pool* || *innodb_secondary_buffer_pool* || *result* ||
|| 128M || 0|| 1039.3 tpmC || 
|| 128M || 512M || 1733.45 tpmC ||
|| 128M || 920M || 1878.9 tpmC ||

= Configuration =

1. create the file on flash memory, we use this file as secondary buffer pool. (In windows, InnoDB will auto create this file)

{{{
dd if=/dev/zero of=ib_sbpfile bs=16384 count=58880 
}}}

2. edit the my.cnf file, add followings:

{{{
[mysqld]
innodb-secondary-buffer-pool-size=920M
innodb-secondary-buffer-pool-file=/flash/ib_sbpfile
}}}


3. watch secondary buffer pool status using show innodb status\G:
{{{
mysql> show engine innodb status\G;
*************************** 1. row ***************************
......
----------------------
SECONDARY BUFFER POOL
----------------------
Secondary buffer pool size      58880
Free pages      126
LRU pages       58754
Page reads 971180, sync 548939, swap 490185
Secondary buffer pool hit rate 916 / 1000 (in 23.00 sec)
649.10 reads/s, 334.16 sync/s, 336.25 swap/s (in 23.00 sec)
......
}}}
4. new innodb status variables:
{{{
mysql> show global status like 'innodb_sec%';         
+------------------------------------+---------+
| Variable_name                      | Value   |
+------------------------------------+---------+
| Innodb_secondary_buffer_pool_reads | 1106312 |
| Innodb_secondary_buffer_pool_sync  | 619074  |
| Innodb_secondary_buffer_pool_swap  | 560194  |
+------------------------------------+---------+
3 rows in set (0.00 sec)
}}}

= Next New Feature =
 # allow to pin the table into secondary buffer pool.
 # add LRU aglorithm to secondary buffer pool.
 # add secondary buffer pool status info to INFORMATION_SCHEMA.
  